<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Number Theoretic Transforms in ML DSA</title>
  <style>
    /* Default styles provided by pandoc.
    ** See https://pandoc.org/MANUAL.html#variables-for-html for config info.
    */
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {  background-color: #f8f8f8; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ef2929; } /* Alert */
    code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #204a87; } /* Attribute */
    code span.bn { color: #0000cf; } /* BaseN */
    code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4e9a06; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #8f5902; font-style: italic; } /* Comment */
    code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
    code span.dt { color: #204a87; } /* DataType */
    code span.dv { color: #0000cf; } /* DecVal */
    code span.er { color: #a40000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #0000cf; } /* Float */
    code span.fu { color: #204a87; font-weight: bold; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
    code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
    code span.ot { color: #8f5902; } /* Other */
    code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
    code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
    code span.ss { color: #4e9a06; } /* SpecialString */
    code span.st { color: #4e9a06; } /* String */
    code span.va { color: #000000; } /* Variable */
    code span.vs { color: #4e9a06; } /* VerbatimString */
    code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="style.css" />
  <script defer=""
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Number Theoretic Transforms in ML DSA</h1>
<p class="date">Jan-2026</p>
</header>
<head>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.css" integrity="sha384-Pu5+C18nP5dwykLJOhd2U4Xen7rjScHN/qusop27hdd2drI+lL5KvX7YntvT8yew" crossorigin="anonymous">
<!-- The loading of KaTeX is deferred to speed up page rendering -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/katex.min.js" integrity="sha384-2B8pfmZZ6JlVoScJm/5hQfNS2TI/6hPqDZInzzPc8oHpN5SgeNOf4LzREO6p5YtZ" crossorigin="anonymous"></script>
<!-- To automatically render math in text elements, include the auto-render extension: -->
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.27/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
<link rel="stylesheet" type="text/css" href="https://tikzjax.com/v1/fonts.css">
<script src="https://tikzjax.com/v1/tikzjax.js"></script>
</head>
<p>Number Theoretic Transforms (NTTs) are integral to the ML DSA
specification. The NTT representation enables efficient polynomial
addition, subtraction, and multiplication. In this section, we develop
all the key ideas behind NTTs in a step-by-step fashion. To illustrate
these concepts, we define <em>Tiny DSA</em>, a simplified system that
follows the ML-DSA structure. This development draws heavily from
Prof. Alfred Menezes’ excellent notes and videos.</p>
<h2 id="tiny-dsa---factoring-the-reduction-polynomial-x32-1">Tiny DSA -
Factoring the Reduction Polynomial <span class="math inline">\(x^{32} +
1\)</span></h2>
<p>In this section we derive the irreducible factors of the reduction
polynomial <span class="math inline">\(x^{32} + 1\)</span>.</p>
<p>The first interesting fact to notice is the following equivalence
under the polynomial ring <span class="math inline">\(R_q\)</span> <span
class="math display">\[
\begin{array}{ll}
    x^{32} + 1 &amp; = x^{32} + \ {\boxed{\color{magenta}\zeta^{0}}} \\
               &amp; = x^{32} \ {\boxed{\color{magenta} - \zeta^{32 +
0}}} \\
               &amp; = x^{32} - \zeta^{32}
\end{array}
\]</span></p>
<p>In general, whenever we see a term of the form <span
class="math display">\[
    x^{m} + \zeta^n \in R_q  \qquad m \ge 1, n \ge 0
\]</span> we can replace it with <span class="math display">\[
    x^{m} - \zeta^{32 + n}
\]</span></p>
<h3 id="level-1---factors-of-x32---zeta32">Level 1 - Factors of <span
class="math inline">\(x^{32} - \zeta^{32}\)</span></h3>
<script type="text/tikz">
    \begin{tikzpicture}[
        scale=1.5,
        transform shape,
        level distance=2cm,
        sibling distance=4cm,
        every label/.style={text=blue, font=\scriptsize}
    ]
    % root of the expression tree
    \node (root) {$x^{32} - \zeta^{32}$}
        % left
        child {
            node[label={[]below:{1}}] (left) {$x^{16} - \zeta^{16}$}
            edge from parent node[left, xshift=-2mm, red] {0}
        }
        % right
        child {
            node (right) {$x^{16} - \zeta^{48}$}
            edge from parent node[right, xshift=2mm, red] {1}
        };
\end{tikzpicture}
</script>
<h3 id="level-2---factors-of-x16---zeta16-and-x16---zeta48">Level 2 -
Factors of <span class="math inline">\(x^{16} - \zeta^{16}\)</span> and
<span class="math inline">\(x^{16} - \zeta^{48}\)</span></h3>
<script type="text/tikz">
\begin{tikzpicture}[
        scale=1.5,
        transform shape,
        level distance=2cm,
        level 1/.style={sibling distance=7cm},
        level 2/.style={sibling distance=4cm},
        level 3/.style={sibling distance=2cm},
        every label/.style={text=blue, font=\small}
    ]
    % root of the expression tree
    \node (root) {$x^{32} - \zeta^{32}$}
        % left - 0 - x^16-1
        child {
            node[label={[]below:{1}}] (left) {$x^{16} - \zeta^{16}$}
            % left - 00
            child {
                node[label={[]below:{2}}] {$x^{8} - \zeta^{8}$}
                child {
                    % left - x^4 - \zeta^4 - 000
                    node[label={[text=blue]below:{4}}] {$x^{4} - \zeta^{4}$}
                    edge from parent node[left, xshift=-1mm, red] {000}
                }
                child {
                    % left - x^4 - \zeta^34 - 001
                    node (right001) {$x^{8} - \zeta^{36}$}
                    edge from parent node[right, xshift=1mm, red] {001}
                }
                edge from parent node[left, xshift=-2mm, red] {00}
            }
            % right - 01
            child {
                node (right01) {$x^{8} - \zeta^{40}$}
                child {
                    % left - x^4 - \zeta^4 - 010
                    node[label={[]below:{5}}] {$x^{4} - \zeta^{20}$}
                    edge from parent node[left, xshift=-1mm, red] {010}
                }
                child {
                    % left - x^4 - \zeta^34 - 011
                    node (right011) {$x^{8} - \zeta^{52}$}
                    edge from parent node[right, xshift=1mm, red] {011}
                }
                edge from parent node[right, xshift=2mm, red] {01}
            }
            edge from parent node[left, xshift=-3mm, red] {0}
        }
        % right -1
        child {
            node (right1) {$x^{16} - \zeta^{48}$}
            % left - 10
            child {
                node[label={[]below:{3}}] (left10) {$x^{8} - \zeta^{24}$}
                edge from parent node[left, xshift=-2mm, red] {10}
            }
            % right - 11
            child {
                % Renamed from (right) to (right11)
                node (right11) {$x^{8} - \zeta^{56}$}
                edge from parent node[right, xshift=2mm, red] {11}
            }
            edge from parent node[right, xshift=3mm, red] {1}
        };
\end{tikzpicture}
</script>
<h3
id="level-3---factors-of-x8---zeta8-x8---zeta40-x8---zeta24-and-x8---zeta56">Level
3 - Factors of <span class="math inline">\(x^{8} - \zeta^8, \ x^{8} -
\zeta^{40}, \ x^{8} - \zeta^{24}\)</span> and <span
class="math inline">\(x^{8} - \zeta^{56}\)</span></h3>

<h3 id="level-4">Level 4</h3>
<script type="text/tikz">
    \begin{tikzpicture}[
        scale=1.25,
        transform shape,
        every label/.style={text=blue, font=\small},
        level distance=2.3cm,
        level 1/.style={sibling distance=17.6cm},
        level 2/.style={sibling distance=9cm},
        level 3/.style={sibling distance=4.5cm},
        level 4/.style={sibling distance=2.3cm},
        %level 5/.style={sibling distance=1.5cm},
        level 5/.style={
            sibling distance=1cm,
        },
        level 5 left/.style={
            level distance=2cm,
            edge from parent path={(\tikzparentnode.south) -- (\tikzchildnode.north)}
        },
        level 5 right/.style={
            level distance=4cm,
            edge from parent path={(\tikzparentnode.south) -- (\tikzchildnode.north)}
        },
    ]
    % root of the expression tree
    \node (root) {$x^{32} - \zeta^{32}$}
        % left - 0 - x^16-1
        child {
            node[label={below:{1}}] (left) {$x^{16} - \zeta^{16}$}
            % left - 00
            child {
                node[label={below:{2}}] {$x^{8} - \zeta^{8}$}
                child {
                    % left - x^4 - \zeta^4 - 000
                    node[label={below:{4}}] {$x^{4} - \zeta^{4}$}
                    child {
                        % left - x^2 - \zeta^2 - 0000
                        node[label={above:{8}}] {$x^{2} - \zeta^{2}$}
                        child [level 5 left] {
                            % left: x - \zeta - 00000
                            node[label={[xshift=-2mm, yshift=-2mm]above:{16}}] {$x - \zeta$}
                            edge from parent node[left, xshift=-0.3mm, red] {00000}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{33} - 00001
                            node (right00001) {$x- \zeta^{33}$}
                            edge from parent node[right, xshift=2mm, yshift=-1cm, red] {00001}
                        }
                        edge from parent node[left, xshift=-0.3mm, red] {0000}
                    }
                    child {
                        % left - x^2 - \zeta^34 - 0001
                        node (right0001) {$x^{2} - \zeta^{34}$}
                        child [level 5 left] {
                            % left: x - \zeta^{17} - 00010
                            node[label={[xshift=-2mm, yshift=-2mm]above:{17}}] {$x - \zeta^{17}$}
                            edge from parent node[left, xshift=-0.3mm, red] {00010}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{49} - 00011
                            node (right00011) {$x- \zeta^{33}$}
                            edge from parent node[right, xshift=2mm, yshift=-1cm, red] {00011}
                        }
                        edge from parent node[right, xshift=0.3mm, yshift=0.3mm, red] {0001}
                    }
                    edge from parent node[left, xshift=-1mm, red] {000}
                }
                child {
                    % left - x^4 - \zeta^36 - 001
                    node (right001) {$x^{4} - \zeta^{36}$}
                    child {
                        % left - x^2 - \zeta^18 - 0010
                        node[label={above:{9}}] {$x^{2} - \zeta^{18}$}
                        child [level 5 left] {
                            % left: x - \zeta^{9} - 00100
                            node[label={[xshift=-2mm, yshift=-2mm]above:{18}}] {$x - \zeta^9$}
                            edge from parent node[left, xshift=-0.3mm, red] {00100}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{41} - 00101
                            node (right00101) {$x- \zeta^{41}$}
                            edge from parent node[right, xshift=2mm, yshift=-1cm, red] {00101}
                        }
                        edge from parent node[left, xshift=-0.3mm, red] {0010}
                    }
                    child {
                        % left - x^2 - \zeta^50 - 0011
                        node (right0011) {$x^{2} - \zeta^{50}$}
                        child [level 5 left] {
                            % left: x - \zeta^{25} - 00110
                            node[label={[xshift=-2mm, yshift=-2mm]above:{19}}] {$x - \zeta^{25}$}
                            edge from parent node[left, xshift=-0.3mm, red] {00110}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{57} - 00111
                            node (right00111) {$x- \zeta^{57}$}
                            edge from parent node[right, xshift=2mm, yshift=-1cm, red] {00111}
                        }
                        edge from parent node[right, xshift=0.3mm, yshift=0.3mm, red] {0011}
                    }
                    edge from parent node[right, xshift=1mm, red] {001}
                }
                edge from parent node[left, xshift=-2mm, red] {00}
            }
            % right - 01
            child {
                node (right01) {$x^{8} - \zeta^{40}$}
                child {
                    % left - x^4 - \zeta^4 - 010
                    node[label={[]below:{5}}] {$x^{4} - \zeta^{20}$}
                    child {
                        % left - x^2 - \zeta^10 - 0100
                        node[label={above:{10}}] {$x^{2} - \zeta^{10}$}
                        child [level 5 left] {
                            % left: x - \zeta^{5} - 01000
                            node[label={[xshift=-2mm, yshift=-2mm]above:{20}}] {$x - \zeta^{5}$}
                            edge from parent node[left, xshift=-0.3mm, red] {01000}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{37} - 01001
                            node (right01001) {$x- \zeta^{37}$}
                            edge from parent node[right, xshift=2mm, yshift=-1cm, red] {01001}
                        }
                        edge from parent node[left, xshift=-0.3mm, red] {0100}
                    }
                    child {
                        % left - x^2 - \zeta^42 - 0101
                        node (right0101) {$x^{2} - \zeta^{42}$}
                        child [level 5 left] {
                            % left: x - \zeta^{21} - 01010
                            node[label={[xshift=-2mm, yshift=-2mm]above:{21}}] {$x - \zeta^{21}$}
                            edge from parent node[left, xshift=-0.3mm, red] {01010}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{53} - 01011
                            node (right01011) {$x- \zeta^{53}$}
                            edge from parent node[right, xshift=2mm, yshift=-1cm, red] {01011}
                        }
                        edge from parent node[right, xshift=0.3mm, red] {0101}
                    }
                    edge from parent node[left, xshift=-1mm, red] {010}
                }
                child {
                    % left - x^4 - \zeta^52 - 011
                    node (right011) {$x^{4} - \zeta^{52}$}
                    child {
                        % left - x^2 - \zeta^26 - 0110
                        node[label={above:{11}}] {$x^{2} - \zeta^{26}$}
                        child [level 5 left] {
                            % left: x - \zeta^{13} - 01100
                            node[label={[xshift=-2mm, yshift=-2mm]above:{22}}] {$x - \zeta^{13}$}
                            edge from parent node[left, xshift=-0.3mm, red] {01100}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{45} - 01101
                            node (right01101) {$x-\zeta^{45}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {01101}
                        }
                        edge from parent node[left, xshift=-0.3mm, red] {0110}
                    }
                    child {
                        % left - x^2 - \zeta^58 - 0111
                        node (right0111) {$x^{2} - \zeta^{58}$}
                        child [level 5 left] {
                            % left: x - \zeta^{29} - 01110
                            node[label={[xshift=-2mm, yshift=-2mm]above:{23}}] {$x-\zeta^{29}$}
                            edge from parent node[left, xshift=-0.3mm, red] {01110}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{61} - 01111
                            node (right01111) {$x-\zeta^{61}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {01111}
                        }
                        edge from parent node[right, xshift=0.3mm, red] {0111}
                    }
                    edge from parent node[right, xshift=1mm, red] {011}
                }
                edge from parent node[right, xshift=2mm, red] {01}
            }
            edge from parent node[left, yshift=3mm, red] {0}
        }
        % right -1
        child {
            node (right1) {$x^{16} - \zeta^{48}$}
            % left - 10
            child {
                node[label={[]below:{3}}] (left10) {$x^{8} - \zeta^{24}$}
                child {
                    % left - x^4 - \zeta^12 - 100
                    node[label={[]below:{6}}] {$x^{4} - \zeta^{12}$}
                    child {
                        % left - x^2 - \zeta^6 - 1000
                        node[label={above:{12}}] {$x^{2} - \zeta^{6}$}
                        child [level 5 left] {
                            % left: x - \zeta^{3} - 10000
                            node[label={[xshift=-2mm, yshift=-2mm]above:{24}}] {$x-\zeta^{3}$}
                            edge from parent node[left, xshift=-0.3mm, red] {10000}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{35} - 10001
                            node (right10001) {$x-\zeta^{35}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {10001}
                        }
                        edge from parent node[left, xshift=-0.3mm, red] {1000}
                    }
                    child {
                        % left - x^2 - \zeta^38 - 1001
                        node (right1001) {$x^{2} - \zeta^{38}$}
                        child [level 5 left] {
                            % left: x - \zeta^{19} - 10010
                            node[label={[xshift=-2mm, yshift=-2mm]above:{25}}] {$x-\zeta^{19}$}
                            edge from parent node[left, xshift=-0.3mm, red] {10010}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{51} - 10001
                            node (right10011) {$x-\zeta^{51}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {10011}
                        }
                        edge from parent node[right, xshift=0.3mm, red] {1001}
                    }
                    edge from parent node[left, xshift=-1mm, red] {100}
                }
                child {
                    % left - x^4 - \zeta^34 - 101
                    node (right101) {$x^{4} - \zeta^{44}$}
                    child {
                        % left - x^2 - \zeta^22 - 1000
                        node[label={above:{13}}] {$x^{2} - \zeta^{22}$}
                        child [level 5 left] {
                            % left: x - \zeta^{11} - 10000
                            node[label={[xshift=-2mm, yshift=-2mm]above:{26}}] {$x-\zeta^{11}$}
                            edge from parent node[left, xshift=-0.3mm, red] {10000}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{43} - 10001
                            node (right10001) {$x-\zeta^{43}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {10001}
                        }
                        edge from parent node[left, xshift=-0.3mm, red] {1010}
                    }
                    child {
                        % left - x^2 - \zeta^54 - 1001
                        node (right1011) {$x^{2} - \zeta^{54}$}
                        child [level 5 left] {
                            % left: x - \zeta^{27} - 10010
                            node[label={[xshift=-2mm, yshift=-2mm]above:{27}}] {$x-\zeta^{27}$}
                            edge from parent node[left, xshift=-0.3mm, red] {10010}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{59} - 10011
                            node (right10011) {$x-\zeta^{59}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {10011}
                        }
                        edge from parent node[right, xshift=0.3mm, red] {1011}
                    }
                    edge from parent node[right, xshift=1mm, red] {101}
                }
                edge from parent node[left, xshift=-2mm, red] {10}
            }
            % right - 11
            child {
                % Renamed from (right) to (right11)
                node (right11) {$x^{8} - \zeta^{56}$}
                child {
                    % left - x^4 - \zeta^28 - 110
                    node[label={[]below:{7}}] {$x^{4} - \zeta^{28}$}
                    child {
                        % left - x^2 - \zeta^14 - 1100
                        node[label={above:{14}}] {$x^{2} - \zeta^{14}$}
                        child [level 5 left] {
                            % left: x - \zeta^{7} - 11000
                            node[label={[xshift=-2mm, yshift=-2mm]above:{28}}] {$x-\zeta^{7}$}
                            edge from parent node[left, xshift=-0.3mm, red] {11000}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{39} - 11001
                            node (right11001) {$x-\zeta^{39}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {11001}
                        }
                        edge from parent node[left, xshift=-0.3mm, red] {1100}
                    }
                    child {
                        % left - x^2 - \zeta^46 - 1101
                        node (right1101) {$x^{2} - \zeta^{46}$}
                        child [level 5 left] {
                            % left: x - \zeta^{23} - 11010
                            node[label={[xshift=-2mm, yshift=-2mm]above:{29}}] {$x-\zeta^{23}$}
                            edge from parent node[left, xshift=-0.3mm, red] {11010}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{55} - 11011
                            node (right11011) {$x-\zeta^{55}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {11011}
                        }
                        edge from parent node[right, xshift=0.3mm, red] {1101}
                    }
                    edge from parent node[left, xshift=-1mm, red] {110}
                }
                child {
                    % left - x^4 - \zeta^60 - 111
                    node (right111) {$x^{4} - \zeta^{60}$}
                    child {
                        % left - x^2 - \zeta^30 - 1110
                        node[label={above:{15}}] {$x^{2} - \zeta^{30}$}
                        child [level 5 left] {
                            % left: x - \zeta^{15} - 11100
                            node[label={[xshift=-2mm, yshift=-2mm]above:{30}}] {$x-\zeta^{15}$}
                            edge from parent node[left, xshift=-0.3mm, red] {11100}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{47} - 11101
                            node (right11101) {$x-\zeta^{47}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {11101}
                        }
                        edge from parent node[left, xshift=-0.3mm, red] {11101}
                    }
                    child {
                        % left - x^2 - \zeta^62 - 1111
                        node (right1111) {$x^{2} - \zeta^{62}$}
                        child [level 5 left] {
                            % left: x - \zeta^{31} - 11110
                            node[label={[xshift=-2mm, yshift=-2mm]above:{31}}] {$x-\zeta^{31}$}
                            edge from parent node[left, xshift=-0.3mm, red] {11110}
                        }
                        child [level 5 right] {
                            % right: x - \zeta^{63} - 11111
                            node (right11111) {$x-\zeta^{63}$}
                            edge from parent node[right, xshift=1mm, yshift=-1cm, red] {11111}
                        }
                        edge from parent node[right, xshift=0.3mm, red] {1111}
                    }
                    edge from parent node[right, xshift=1mm, red] {111}
                }
                edge from parent node[right, xshift=2mm, red] {11}
            }
            edge from parent node[right, yshift=3mm, red] {1}
        };
    \end{tikzpicture}
</script>
<h1 id="tiny-dsa-and-number-theoretic-transforms">Tiny DSA and Number
Theoretic Transforms</h1>
<p>Tiny DSA uses the following constants, symbols, and mathematical
expressions:</p>
<p><span class="math display">\[
\begin{array}{rll}
&amp;q &amp; \text{The prime number} \ q = 2^{10} - 2^8 + 1 = 769.\\\\
&amp;\mathbb{N} &amp; \text{The set of natural numbers}.\\\\
&amp;\mathbb{Z} &amp; \text{The ring of integers}.\\
&amp;\mathbb{Z}_q &amp; \text{The ring of integers modulo} \ q \
\text{whose set of elements is} \ \{0, 1, \ldots, q-1\}.\\
&amp;\mathbb{Z}^n_q &amp; \text{The set of $n$-tuples over $Z_q$}.\\\\
&amp;T_q &amp; \text{The ring} \ \Pi_{j=0}^{32}\,\mathbb{Z}_q. \\\\
R &amp; Z[X]/(X^{32}+1) &amp;  \text{The ring of single-variable
polynomials over} \ \mathbb{Z} \ \text{modulo} \ X^{32}+1. \\
    &amp;&amp; \text{The coefficients of polynomials in} \ R \
\text{belong to the ring} \ \mathbb{Z}.\\
    &amp;&amp; \text{The highest-degree term is at most} \ x^{31}.\\\\
R_q &amp; Z_q[X]/(X^{32}+1) &amp;  \text{The ring of single-variable
polynomials over} \ \mathbb{Z}_q \ \text{modulo} \ X^{32}+1. \\
    &amp;&amp; \text{The coefficients of polynomials in} \ R_q \
\text{belong to the ring} \ \mathbb{Z}_q.\\
    &amp;&amp; \text{The highest-degree term is at most} \ x^{31}. \\\\
    &amp; (X^{32}+1) &amp; \text{The} \ reduction \ polynomial. \\\\
\omega, \ z, \ zeta \ \ &amp; \zeta &amp; \text{The} \ \mathbf{primitive
\ 64^{th} \ root} \ \text{of unity in} \ \mathbb{Z}_q. \\
    &amp;&amp; \zeta^{64} \equiv 1 \ \text{mod} \ q.\\
    &amp;&amp; \zeta^k \not\equiv 1 \ \text{mod} \ q \ for \ all \ k
&lt; 64.\\
    &amp;&amp; \zeta = 12 \ \text{in Tiny DSA}.\\\\
&amp; \lbrack a, b \rbrack &amp; \text{For two integers} \ a \le b, \
[a, b] \ \text{denotes the set of integers} \ \{a, a+1, \ldots, b
\}.\\\\
\end{array}
\]</span></p>
<h2 id="examples-of-polynomial-rings">Examples of Polynomial Rings</h2>
<p>Polynomial ring <span class="math inline">\(Z[x]\)</span> is the set
of all polynomials with coefficients in <span
class="math inline">\(Z\)</span> = {-<span
class="math inline">\(\infty\)</span>, <span
class="math inline">\(\ldots\)</span>, -1, 0, 1, <span
class="math inline">\(\ldots\)</span>, <span
class="math inline">\(\infty\)</span>}.</p>
<p>Polynomial ring <span class="math inline">\(Z_q[x]\)</span> is the
set of all polynomials with coefficients in <span
class="math inline">\(Z_q\)</span> = {0, 1, <span
class="math inline">\(\ldots\)</span>, <span
class="math inline">\(q-1\)</span>}.</p>
<p><em>Example 1</em> - Polynomial <span class="math inline">\(a(x) \in
\mathbb{Z}[x]\)</span>. <span class="math display">\[
    a(x) = -12 + 20367x - 2081x^{56} + 10x^{1023}
\]</span></p>
<p><span class="math inline">\(\colorbox{gray}{}\)</span></p>
<p><em>Example 2</em> - Polynomial <span class="math inline">\(b(x) \in
\mathbb{Z}_q[x]\)</span>.</p>
<p>The coefficients of <span class="math inline">\(a(x)\)</span> from
<em>Example 1</em> are mapped to <span
class="math inline">\(\mathbb{Z}_q\)</span> in polynomial <span
class="math inline">\(b(x)\)</span> below.</p>
<p>Keep in mind, Tiny DSA defines <span class="math inline">\(q =
769\)</span>.</p>
<p><span class="math display">\[
  \begin{array}{lll}
    a(x) &amp; = &amp; -12 + 20367x - 2081x^{56} + 10x^{1023}\\
    b(x) &amp; = &amp; (-12 \ \text{mod} \ 769) \\
        &amp;   &amp; \, + \, (20367 \ \text{mod} \ 769) x \\
        &amp;   &amp; \, + \, (-(2081 \ \text{mod} \ 769) \ \text{mod} \
769)x^{56} \\
        &amp;   &amp; \, + \, 10x^{1023} \\
        &amp; = &amp; \, (769-12) + 373x + (769-543)x^{56} +
10x^{1023}\\
        &amp; = &amp; \, 757 + 373x + 226x^{56} + 10x^{1023}\\
\end{array}
\]</span></p>
<p><span class="math inline">\(\colorbox{gray}{}\)</span></p>
<h2 id="examples-of-polynomials-in-tiny-dsa">Examples of Polynomials in
Tiny DSA</h2>
<p>If polynomial <span class="math inline">\(a(x) \in R[x]\)</span>, its
coefficients are in the ring <span
class="math inline">\(\mathbb{Z}\)</span> and its highest-degree term is
at most <span class="math inline">\(x^{31}\)</span>.</p>
<p>If polynomial <span class="math inline">\(a(x) \in R_q[x]\)</span>,
its coefficients are in the ring <span
class="math inline">\(\mathbb{Z}_q\)</span> and its highest-degree term
is at most <span class="math inline">\(x^{31}\)</span>.</p>
<p><em>Example 1</em> - Polynomial <span class="math inline">\(a(x) \in
R_q[x]\)</span>.</p>
<p>In the polynomial <span class="math inline">\(a(x) = 7 +
23x^{31}\)</span>, first term is the lowest-degree term, and the second,
the highest-degree term.</p>
<p><span class="math inline">\(\colorbox{gray}{}\)</span></p>
<p><em>Example 2</em> - Polynomial <span class="math inline">\(a(x) \in
R_q\)</span>.</p>
<p>Consider the polynomial <span class="math inline">\(a(x) = 63 + 159x
+ 48x^2 + 746x^{28} + x^{30}\)</span>. Its coefficients are in <span
class="math inline">\(\mathbb{Z_q}\)</span>, and the highest-degree term
is <span class="math inline">\(x^{30}\)</span>. Therefore, <span
class="math inline">\(a(x) \in R_q\)</span>.</p>
<p><span class="math inline">\(\colorbox{gray}{}\)</span></p>
<p><em>Example 3</em> - Polynomial <span class="math inline">\(a(x) \in
R \ \text{and} \ a(x) \not\in R_q\)</span>.</p>
<p>Consider the polynomial <span class="math inline">\(a(x) = 2163 -
169x + 1048x^2 - 1746x^{28} + 2x^{30} \in R\)</span>. Note <span
class="math inline">\(a(x) \not\in R_q\)</span> because <strong><em>not
all coefficients</em></strong> are in <span
class="math inline">\(Z_q\)</span>. The coefficients of all terms except
the last one are in <span class="math inline">\(\mathbb{Z}\)</span>.</p>
<p><span class="math inline">\(\colorbox{gray}{}\)</span></p>
<p><em>Example 4</em> - Transform <span class="math inline">\(a(x) \in
R\)</span> to <span class="math inline">\(b(x) \in R_q\)</span>.</p>
<p>For a number <span class="math inline">\(z \in \ \mathbb{Z}\)</span>,
<span class="math inline">\(z \ \text{mod} \ q\)</span> maps it to <span
class="math inline">\(\mathbb{Z}_q\)</span>. Therefore, given a
polynomial <span class="math inline">\(a(x) \in R\)</span>, transforming
its coefficients <em>mod 769</em> transforms the polynomial to <span
class="math inline">\(R_q\)</span>.</p>
<p><span class="math display">\[
\begin{array}{llll}
a(x) &amp; = &amp; 2163 - 169x + 1048x^2 - 1746x^{28} + 2x^{30} &amp;
\in R\\
b(x) &amp; = &amp; (2163 \ mod \ 769) \\
    &amp;   &amp; \, + \, (-169 \ mod \ 769) x \\
    &amp;   &amp; \, + \, (1048 \ mod \ 769)x^2 \\
    &amp;   &amp; \, + \, ((-(1746 \ mod \ 769) \ mod \ 769))x^{28} \\
    &amp;   &amp; \, + \, (2 \ mod \ 769) x^{30} \\
   &amp; = &amp; 625 + 600x + 279x^2 +  561x^{28} + 2x^{30} &amp; \in
R_q\\
\end{array}
\]</span></p>
<p><span class="math inline">\(\colorbox{gray}{}\)</span></p>
<p><a id="primitives-roots-of-unity"></a></p>
<h2 id="primitives-roots-of-unity">Primitive Roots of Unity</h2>
<p>Let <span class="math inline">\(n = 2^k\)</span>, and let <span
class="math inline">\(q\)</span> be a prime such that <span
class="math inline">\(q-1\)</span> is divisible by <span
class="math inline">\(2n\)</span>.</p>
<p><span class="math display">\[
\begin{array}{rlll}
n &amp; = \ 32 &amp; = 2^5\\
2n &amp; = \ 64 &amp; = 2^6 \\
q &amp; = \ 2^{10} - 2^{8} + 1 &amp; = 769\\
q-1 &amp; = \ 2^8(2^2 - 1) &amp; = 768\\
(q-1)/2n &amp; = \ 2^8(2^2 - 1)/2^6 &amp; = 12\\
\end{array}
\]</span></p>
<p>Let <span class="math inline">\(\zeta \in \mathbb{Z}_q\)</span> be an
element of order <span class="math inline">\(2n\)</span>. The order of
of <span class="math inline">\(\zeta\)</span> is the smallest positive
integer <span class="math inline">\(t\)</span> such that <span
class="math inline">\(\zeta^t = 1\)</span>.</p>
<p>In Tiny DSA, <span class="math inline">\(\zeta = 12\)</span>, <span
class="math inline">\(\zeta^{2n} \equiv 1  \ \text{mod} \ q\)</span>,
and <span class="math inline">\(\zeta^n \equiv -1 \ \text{mod} \
q\)</span>.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode numberSource number-lines python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># python3</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>n <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>q <span class="op">=</span> <span class="dv">769</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>z <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="cf">assert</span> <span class="bu">pow</span>(z, <span class="dv">2</span><span class="op">*</span>n, q) <span class="op">==</span> <span class="dv">1</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="cf">assert</span> <span class="bu">pow</span>(z, n, q) <span class="op">==</span> q<span class="op">-</span><span class="dv">1</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># following two expressions evaluate to the same value.</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="cf">assert</span> <span class="bu">pow</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, q) <span class="op">==</span> q<span class="op">-</span><span class="dv">1</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="cf">assert</span> <span class="op">-</span><span class="dv">1</span> <span class="op">%</span> q <span class="op">==</span> q<span class="op">-</span><span class="dv">1</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># this follows directly from the above expressions.</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="cf">assert</span> <span class="op">-</span><span class="dv">1</span> <span class="op">%</span> q <span class="op">==</span> <span class="bu">pow</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, q)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># for all k &lt; 64, z^k != 1 mod q.</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># in other words, there is no k in [1, 63] such that z^k = 1 mod q</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="cf">assert</span> <span class="kw">not</span> <span class="bu">any</span>([<span class="bu">pow</span>(z, k, q)<span class="op">==</span><span class="dv">1</span> <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">2</span><span class="op">*</span>n)])</span></code></pre></div>
<h2 id="ntt-definition">NTT Definition</h2>
<p>Let <span class="math inline">\(a(x) \in R_q\)</span>.</p>
<p>Define NTT(a) = <span class="math inline">\(\hat{a}\)</span> =
(a(<span class="math inline">\(\zeta\)</span>), a(<span
class="math inline">\(\zeta^3\)</span>), a(<span
class="math inline">\(\zeta^5\)</span>), <span
class="math inline">\(\ldots\)</span>, a(<span
class="math inline">\(\zeta^{2n-1}\)</span>)) <span
class="math inline">\(\in Z^n_q\)</span>. NTT(a) is a
<strong><em>polynomial evaluation</em></strong> of <span
class="math inline">\(a(x)\)</span> at <span
class="math inline">\(\zeta\)</span>, <span
class="math inline">\(\zeta^3\)</span>, <span
class="math inline">\(\zeta^5\)</span>, <span
class="math inline">\(\ldots\)</span>, <span
class="math inline">\(\zeta^{2n-1}\)</span>.</p>
<figure style="text-align: center;">
<figure>
<img src="./images/factors-of-reduct-poly.png"
alt="The Irreducible Factors of X^{32}+1" />
<figcaption aria-hidden="true">The Irreducible Factors of <span
class="math inline">\(X^{32}+1\)</span></figcaption>
</figure>
</figure>
<h1 id="references">References</h1>
<p>V4: The Number-Theoretic Transform (NTT). <span
class="math inline">\(\copyright\)</span> Alfred Menezes. August 2024.
<a
href="https://cryptography101.ca/wp-content/uploads/2024/12/V4-slides-Kyber-and-Dilithium.pdf"
class="uri">https://cryptography101.ca/wp-content/uploads/2024/12/V4-slides-Kyber-and-Dilithium.pdf</a></p>
</body>
</html>
